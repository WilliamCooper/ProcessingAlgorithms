# The State of the Aircraft {#the-state-of-the-aircraft}

The primary sources of information on the location and motion of the aircraft are inertial navigation systems and global positioning systems. Both are described in this section, and combined results that merge the best features of each into composite variables for location and motion are also discussed. Useful references for material in this section are <a href="http://nldr.library.ucar.edu/repository/assets/technotes/TECH-NOTE-000-000-000-064.pdf">Lenschow (1972)</a> and <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.  

## Inertial Reference Systems {#inertial-reference-systems}

An Inertial Navigation System (INS) or Inertial Reference Unit (IRU) provides measurements of aircraft position, velocity relative to the Earth, acceleration and attitude or orientation. The IRU provides basic measurements of acceleration and angular rotation rate, while the INS integrates those measurements to track the position, altitude, velocity, and orientation of the aircraft. For the GV, the system is a Honeywell Laseref IV HG2001 GD03 Inertial Reference System; for the C-130, it is a Honeywell Model HG1095-AC03 Laseref V SM Inertial Reference System. These systems are described on the EOL web site, at <a href="http://www.eol.ucar.edu/instruments/inertial-navigation-system-aka-inertial-reference-unit">this URL</a>. Data from the IRS come via a serial digital bit stream (the ARINC digital bus) to the <a name='ads'>ADS</a> (Aircraft Data System). Because there is some delay in transmission and recording of these variables, adjustments for this delay are made when the measurements are merged into the processed data files, as documented in the NetCDF header files and as discussed in Section \@ref(synchronization-of-measurements). Typical delays are about 80 ms for variables including ACINS, PITCH, ROLL, and THDG.  

Some variables are recorded only on the original “raw” data tapes and are not usually included in final archived data files; these are discussed at the end of this subsection. See also the discussion in Section \@ref(obsolete-variables) for information on results from inertial systems that were used prior to installation of the present Honeywell systems.<span id="punch3.1" label="punch3.1">[punch3.1]</span>  

An Inertial Navigation System “aligns” while the aircraft is stationary by measurement of the variations in its reference frame caused by the rotation of the Earth. Small inaccuracy in that alignment leads to a “Schuler oscillation” that produces oscillatory errors in position and other measurements, with a period $\tau_{Sch}$ of about 84 minutes ($\tau_{Sch}=2\pi\sqrt{R_{E}/g}$). Position errors of less than $1.0\,$n mi/h are within normal operating specifications. See Section \@ref(combining-irs-and-gps-measurements) for discussion of additional variables, similar to the following, for which corrections are made for these errors via reference to data from a Global Positioning System.  

Some projects have used smaller Systron Donner C-MIGITS Inertial Navigation Systems with GPS coupling, usually in connection with special instruments like a wing-mounted wind-sensing system. For these units, variable names usually begin with the letter C but otherwise have names matching the following variables (e.g., CLAT). GPS coupling via a Kalman filter is incorporated in the measurements from these units. They are described at <a href="https://www.eol.ucar.edu/instruments/c-migits-insgps-system">this web address</a>.

Uncertainties associated with measurements from the IRS are discussed in a Technical Note, available at <a href="http://dx.doi.org/10.5065/D60G3HJ8">this URL</a>. See page 7 of that document and the tables on pages 41 and 49.  

### Standard Variables

#### Latitude (<span class="math inline">º</span>): LAT {#latitude .unnumbered}

*The aircraft latitude or angular distance north of the equator in an Earth reference frame.*  Positive values are north of the equator; negative values are south. The resolution is 0.00017$^{\circ}$
and the accuracy is reported by the manufacturer to be 0.164$^{\circ}$
after 6 h of flight. Values are provided by the INS at a frequency of 10 Hz.  

#### Longitude (<span class="math inline">º</span>): LON {#longitude .unnumbered}

*The aircraft longitude or angular distance east of the prime meridian in an Earth reference frame.* Positive values are east of the prime meridian; negative values are west. The resolution is 0.00017$^{\circ}$
and the accuracy is reported by the manufacturer to be 0.164$^{\circ}$
after 6 h of flight. Values are provided by the INS at a frequency of 10 Hz.  

#### Aircraft True Heading ($^{\circ}$: THDG {#thdg .unnumbered}

*The azimuthal angle between the center-line of the aircraft (pointing ahead, toward the nose) and a line of meridian.* This azimuthal angle is measured in a polar coordinate system oriented relative to the Earth with polar axis upward and azimuthal angle measured relative to true north. The heading thus indicates the orientation of the aircraft, not necessarily the direction in which the aircraft is traveling. The resolution is 0.00017$^{\circ}$
and the uncertainty is quoted by the manufacturer as 0.2$^{\circ}$
after 6 h of flight. Values are provided by the INS at a frequency of 25 Hz. “True” distinguishes the heading from the magnetic heading, the heading that would be measured by a magnetic compass. For more information on the coordinate system used, see <a href="https://opensky.ucar.edu/islandora/object/archives%3A8152">RAF Bulletin 23</a>.<span id="punch3.2" label="punch3.2">[punch3.2]</span>  

#### Aircraft Pitch Attitude Angle ($^{\circ}$): PITCH {#pitch .unnumbered}

*The angle between the center-line of the aircraft (pointing ahead, toward the nose) and the horizontal plane in a reference frame relative to the Earth with polar axis upward.* Positive values correspond to the nose of the aircraft pointing above the horizon. The resolution is 0.00017$^{\circ}$
and the uncertainty is quoted by the manufacturer as 0.05$^{\circ}$
after 6 h of flight. Values are provided by the INS at a frequency of 50 Hz.  

#### Aircraft Roll Attitude Angle ($^{\circ}$): ROLL {#roll .unnumbered}

*The angle of rotation about the longitudinal axis of the aircraft required to bring the lateral axis (along the wings) to the horizontal plane.* Positive angles indicate that the starboard (right) wing is down ((i.e., a clockwise rotation has occurred from level when facing forward in the aircraft). The resolution is 0.00017$^{\circ}$
and the uncertainty is quoted by the manufacturer as 0.05$^{\circ}$
after 6 h of flight. Values are provided by the INS at a frequency of 50 Hz.  

#### Aircraft Vertical Acceleration (m/s^2^): ACINS {#ACINS .unnumbered}

*The acceleration upward (relative to the Earth) as measured by an inertial reference unit.* With INSs now in use, the internal drift that arises when this measurement is integrated to get aircraft vertical speed and then altitude is removed by the INS via pressure damping through reference to the pressure altitude.^[For earlier projects using the Litton LTN-51 INS, this is a direct measurement without adjustment for changes in gravity during flight and without pressure-damping. Previous use employed a baro-inertial loop to compensate for drift in the integrated measurement. See the discussion of WP3 below.]
Positive values are upward. The sample rate is 50 Hz and the resolution is 0.0024 m/s$^{2}$. 

#### Computed Aircraft Vertical Velocity (m/s): VSPD {#vspd .unnumbered}

*The upward velocity of the aircraft, or rate-of-climb relative to the Earth, as measured by the INS.* VSPD is determined within the INS by integration of the vertical acceleration, with damping based on measured pressure to correct for accumulated errors in the integration of acceleration. The sample rate is 50 Hz with a resolution of 0.00016 m/s. The Honeywell Laseref INS employs a baro-inertial loop, similar to that described below for WP3 and the Litton LTN-51, to update the value of the acceleration. This variable is also filtered within the INS so that there is little variance with frequency higher than 0.1 Hz.  

#### Aircraft Rate of Climb (m/s): ROC (new 2017) {#roc .unnumbered}

*The rate of climb or upward speed of the aircraft,* as measured by the INS with correction so as to represent the derivative of the geometric height. This variable is calculated by integration of the variable ACINS and then addition of the low-pass-filtered difference between that integral and the climb rate determined from the hydrostatic equation. The result retains the high-frequency response from the INS while matching the low-frequency average value determined from the hydrostatic equation, and so represents change in geometric height. <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107f.pdf">This memo</a> contains additional background information on this variable.<br />  
```{r child = 'ROCbox.Rmd'}
```

#### Pressure-Damped Aircraft Vertical Velocity (m/s): WP3 {#wp3 .unnumbered}

<span id="WP3 algorithm" label="WP3 algorithm"></span>This was a derived variable incorporating a third-order damping feedback loop to remove the drift from the inertial system’s vertical accelerometer (ACINS or VZI) using pressure altitude (PALT) as a long-term, stable reference. Positive values are up. The Honeywell INS now in use provides its own version of this measurement, VSPD, and WP3 is now considered obsolete (and in any case should not be calculated from ACINS as provided by the Honeywell Laseref IRS because that ACINS already incorporates pressure damping). Documentation is included here because many old data files include this variable. Note that “pressure altitude” is not a true altitude but an altitude equivalent to the ambient pressure in a standard atmosphere, so updating a variable integrated from inertial measurements to this value can introduce errors vs. the true altitude. WP3 was calculated by the data-processing software as follows (with coefficients in historical use and not updated to the recommendations elsewhere in this technical note):^[Regarding signs, note that ACINS is a number near zero, not near g, and so already has the estimated acceleration of gravity removed. The assumption made in the following is that the INS will report values adjusted for the gravitational acceleration *at the point of alignment*, which would be <span class="math inline">*G*<sub>*L*</sub></span>. If <span class="math inline">*g*<sub>*F*</sub></span>, the estimate for gravity at the flight altitude (palt) and latitude (lat), is *smaller* than <span class="math inline">*G*<sub>*L*</sub></span> then the difference (<span class="math inline">*G*<sub>*L*</sub> − *g*<sub>*f*</sub></span>) will be positive; this will correct for the reference value for ACINS being the gravity measured at alignment (<span class="math inline">*G*<sub>*L*</sub></span>) when it should actually be the sensed gravity (<span class="math inline">*g*<sub>*f*</sub></span>) at the measurement point, so to obtain (sensed acceleration - <span class="math inline">*g*<sub>*f*</sub></span>) it is necessary to add (<span class="math inline">*G*<sub>*L*</sub> − *g*<sub>*f*</sub></span>) to ACINS, *increasing* “acz” in this case. However, the situation with “vcorac” is reversed: “vcorac” is a positive term for all eastward flight, for example, but in that case the motion of the aircraft makes objects seem lighter (i.e., they experience less acceleration of gravity) than without such flight. ACINS is positive upward so it represents a net acceleration of the aircraft upward (as imposed by the combination of gravity and the lift force of the aircraft). To accomplish level flight in these circumstances, the aircraft must actually accelerate downward so the accelerometer will experience a negative excursion relative to slower flight. To compensate, “vcorac” must make a positive contribution to remove that negative excursion from “acz”. In the conceptual extreme that the aircraft flies fast enough for the interior to appear weightless, ACINS would reduce to *-G*<sub>*L*</sub> and vcorac would increase to *+G*<sub>*L*</sub>, leaving acz near zero as required if the aircraft were to remain in level flight in the rotating frame.]
<br />  
```{r child = 'WP3box.Rmd'}
```

#### Inertial Altitude (m): ALT {#alt .unnumbered}

*The altitude of the aircraft as provided by an INS*, with pressure damping applied within the INS to the integrated aircraft vertical velocity to avoid the accumulation of errors. The value therefore is updated to the pressure altitude, not the geometric altitude, and should be regarded as a measurement of pressure altitude that has short-term variations as provided by the INS. The sample rate is 25 Hz with a resolution of 0.038 m. In some projects ALT also referred to the altitude from the avionics GPS system; the preferred and current variable name for that is ALT_G.<span id="punch3.10" label="punch3.10">[punch3.10]</span>  

#### Aircraft Ground Speed (m/s): GSF {-#gsf}

*The ground speed of the aircraft as provided by an INS.* The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Aircraft Ground Speed East Component (m/s): VEW {#vew .unnumbered}

*The east-directed component of ground speed as provided by an INS.* The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Aircraft Ground Speed North Component (m/s): VNS {#vns .unnumbered}

*The north-directed component of ground speed as provided by an INS.* The resolution is 0.0020 m/s, and the INS provides this measurement at a frequency of 10 Hz.  

#### Distance East/North of a Reference (km): DEI, DNI {#dei-dni .unnumbered}

*Distance east or north of a project-dependent reference point.* These are derived outputs obtained by subtracting a fixed reference position from the current position. The values are determined from measurements of latitude and longitude and converted from degrees to distance in a rectilinear coordinate system. The reference position can be either the starting location of the flight or a user-defined reference point (e.g., the location of a project radar). The accuracy of these values is dependent on the accuracy of the source of latitude and longitude measurements (see LAT and LON), and the calculations are only appropriate for short distances because they do not take into account the spherical geometry of the Earth.<span id="punch:3.11" label="punch:3.11">[punch:3.11]</span><br />  
```{r child='DNSbox.Rmd'}
```

#### Radial Azimuth/Distance from Fixed Reference FXAZIM, FXDIST {#fxaxim .unnumbered}

*Azimuth and distance from a project-dependent reference point.* The units of the azimuthal angle are degrees (relative to true north) and the distance is in kilometers. These are calculated by rectangular-to-polar conversion of DEI and DNI, described in the preceding paragraph.  

### Additional Special-Use Variables {#special-use-irs}

The following INS and IRU variables are not normally included in archived data files, but their values are recorded by the ADS and can be obtained from the original “raw” data files:

#### Raw Lateral Body Acceleration (m/s^2^): BLATA {#blata .unnumbered}

The raw output from the IRU lateral accelerometer. Positive values are toward the starboard, normal to the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.  

#### Raw Longitudinal Body Acceleration (m/s^2^): BLONA {#blona .unnumbered}

The raw output from the IRU longitudinal accelerometer. Positive values are in the direction of the nose of the aircraft and parallel to the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.  

#### Raw Normal Body Acceleration (m/s^2^): BNORMA {#bnorma .unnumbered}

The raw output from the IRU vertical accelerometer. Positive values are upward in the reference frame of the aircraft, normal to the aircraft center line and lateral axis. The sample rate is 50 Hz with a resolution of 0.0024 m s^-2^.

#### Raw Body Pitch Rate (<span class="math inline">º</span>/s): BPITCHR {-#bpitchr}

The raw output of the IRU pitch rate gyro. Positive values indicate the nose moving upward and refer to rotation about the aircraft’s lateral axis. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

#### Raw Body Roll Rate (<span class="math inline">º</span>/s): BROLLR {#brollr .unnumbered}

The raw output of the IRU roll rate gyro. Positive values indicate starboard wing moving down and refer to rotation about the aircraft center line. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

#### Raw Body Yaw Rate (<span class="math inline">º</span>/s): BYAWR {#byawr .unnumbered}

The raw output of the IRU yaw rate. Positive values represent the nose turning to the starboard and refer to rotation about the aircraft’s vertical axis. The sample rate is 50 Hz with a resolution of 0.0039<span class="math inline">º</span>/s.  

## Global Positioning Systems {#global-positioning-systems}

Primary GPS variables specifying the position and velocity of the aircraft are provided by GPS receivers, currently a NovAtel Model OEM 5 unit on the GV and a NovAtel Model OEM-4 receiver on the C-130 (to be replaced by an OEM-6 after January 2014). See <a href="http://www.eol.ucar.edu/instruments/research-global-positioning-system">this link</a> for a description of these systems. The coordinate system used for all GPS measurements is the World Geodetic System WGS-84; for details, see <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">this link</a>.^[There are four measures of height or altitude discussed in this technical note, height relative to the WGS-84 reference surface, geometric height relative to mean sea level, geopotential height and pressure height. The WGS-84 height (measured by GPS instruments) is height relative to a reference system in which zero is defined by a specified reference ellipsoid representing the shape of the Earth, as specified here: <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/tr8350_2.html">http://earth-info.nga.mil/GandG/publications/tr8350.2/tr8350_2.html</a>,. This is not defined to be a level surface in the sense of being an equipotential surface. A better approximation of mean sea level is the “geoid”, a surface having constant gravitational equipotential that approximates mean sea level. The geoid is more structured than the WSR-84 reference ellipsoid and departs significantly from it, often by several 10s of meters. Even the geoid does not represent mean sea level exactly because local mean sea level can be influenced by variations in water density, mean wind, or ocean circulation, but the geoid is usually the reference used for measurements labeled “MSL” except when fine-scale local effects must be considered. The geometric height is the true height above a reference surface, often taken to be mean sea level or the geoid; this may therefore differ significantly from the height measured directly by a GPS unit. There is a variable included below, GGEOIDHT, that provides a measure of the difference. Geopotential height is the height above mean sea level that would give the geopotential, or gravitational potential energy per unit mass, of the actual parcel if that mass were raised against standard gravity (not varying, e.g., with latitude or height) to that altitude. For the purpose of this definition, standard gravity is defined to be 9.80665<span class="math inline"> *m* *s*<sup> − 2</sup></span>. Finally, pressure altitude, defined in detail below, is the altitude in the ISA Standard Atmosphere where the pressure matches a specified value; it is not a geometric coordinate but rather a measure of pressure.]
The uncertainty of the position measurements is specified by the manufacturer to be 1.5 m CEP horizontal (3.3 m 95% CEP).^[CEP is the Circular Error Probability, the radius of a circle that contains 50% of the measurements; 95% CEP contains 95% of the measurements. When OnmiSTAR corrections are available (involving extra cost and not available in all areas of the globe, so not available for all projects) the uncertainty decreases to 0.15 m 95% CEP. The vertical uncertainty is about twice as great as the horizontal uncertainty. Because variables are stored as 4-byte single-precision floating point numbers, the inherent storage precision can limit the precision of the recorded position to about 1 m.]
The accuracy of velocity measurements is 0.03 m/s RMS for all axes. All variables are provided by the GPS receivers at 5 Hz. Latitude and longitude are recorded in a special log file (called the GPGGA log) with a resolution of 0.0001 degree, while Earth-relative velocity is recorded in the GPRMC log with resolution of 0.1 m/s. Starting in January 2014 new logs (named BESTPOS and BESTVEL) have also been recorded to preserve more significant digits in the measurements. The BESTPOS log has a position resolution of <span class="math inline">10<sup> − 11</sup>deg </span>, while the BESTVEL log is recorded with 0.0001 m/s resolution.  

Some of the following variables are also available from alternate Garmin GPS16 receivers, for which the variable name is qualified by the name of that unit; e.g., GGLAT_GMN for GGLAT as measured by a Garmin GPS unit. In addition, some of the measurements from the GPS units that are part of the aircraft avionics systems are recorded; these are denoted by a suffix “_G” or “_A”. Measurements from before about 2000 used Trimble TANS-III receivers, <span id="punch3.3" label="punch3.3">[punch3.3]</span>with the ability to track up to 6 satellites at a time but needing only 4 to provide 3-dimensional position and velocity data (3 satellites for 2-dimensions). The accuracy of the position measurements for that unit was stated to be 25 meters (horizontal) and 35 meters (vertical) under “steady-state conditions.”^[The GPS signals at one time suffered from “selective availability,” a US DOD term for a perturbed signal that degraded GPS absolute accuracy to 100 meters. This was especially noticeable in the altitude measurement, so GALT normally was not useful. As of 1 May 2000, selective availability was deactivated to allow everyone to obtain better position measurements. See the Interagency GPS Executive Board web site for more information on selective availability and GPS measurements prior to 2000.]
Likewise, velocity measurements are within 0.2 m/s for all axes. Measurement resolution is that of 4-byte IEEE format (about 6 significant digits). All variables were provided by the Trimble receivers at 1 Hz.  

A special correction is needed for variables GGVEW, GGVNS, and GGVSPD, which measure the motion *at the GPS antenna* relative to the Earth. The conventional wind calculation addresses the difference between the motion at the radome (where the relative wind is measured) and the INS (where variables VEW, VNS, VSPD are measured) arising from rotation of the aircraft. However, if GGVSPD is used instead of VSPD for vertical wind or GGVEW and GGVNS are used (perhaps via the complementary filter) for the horizontal wind, an additional correction is needed for the displacement between the GPS antenna and the INS receiver. On the GV, this distance is -4.30 m. A correction for aircraft rotation is therefore applied to GGVSPD, as described below.   

#### GPS Latitude (<span class="math inline">º</span>): GGLAT, LAT_G; also formerly GLAT {#gglat .unnumbered}

*The aircraft latitude measured by a global positioning system.* Positive values are north of the equator; negative values are south. These variables are recorded in netCDF files as single-precision values. GGLAT is provided by the data-system GPS; LAT_G and LATF_G are from the avionics system GPS. LATF_G is a fine-resolution measurement that requires special processing.</p>

#### GPS Longitude (<span class="math inline">º</span>): GGLON, LON_G; also formerly GLON {#gglon .unnumbered}

*The aircraft longitude measured by a global positioning system.* Positive values are east of the prime meridian; negative are west. GGLON is provided by the (or a) data-system GPS; LON_G and LONF_G are from the avionics system GPS. LONF_G is a fine-resolution measurement that requires special processing. <span id="punch:3-12" label="punch:3-12">[punch:3-12]</span>  

#### GPS Ground Speed (m/s): GGSPD, GSF_G {#ggspd .unnumbered}

*The aircraft ground speed measured by a global positioning system.* GGSPD originates from a data-system GPS; GSF_G originates from an avionics-system GPS.  

#### GPS Ground Speed Vector East Component (m/s): GGVEW, VEW_G {#ggvew .unnumbered}

*The eastward component of ground speed measured by a global positioning system.* GGVEW originates from a data-system GPS; VEW_G originates from an avionics-system GPS. In the case of GGVEW, when this is used in the calculation of horizontal wind, the following correction would be needed:
\begin{equation}
\mathrm{\{GGVEWA\}}=\mathrm{\{GGVEW\}-L_G}\dot{\psi}\frac{\cos\psi}{\cos\phi}
(\#eq:GGVEWA)
\end{equation}  
where GGVEWA is the corrected value used in the wind calculation, , and $\psi$ and $\phi$ are respectively the heading and roll angles, <span class="math inline">*L*<sub>*G*</sub> =  − 4.30</span> m for the GV, and $\dot{\psi}$ is the rate-of-change of heading (in radians). The variable BYAWR transmitted from the INS gives the rate-of-change of heading after conversion from <span class="math inline">$^{\circ}\thinspace s^{-1}$</span> to radians <span class="math inline">*s*<sup> − 1</sup></span>. This correction is not applied in normal processing because the use of the complementary filter, discussed in Sect.\ \@ref(combining-irs-and-gps-measurements), makes it of negligible importance. More information is contained in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this memo</a>.  

#### GPS Ground Speed Vector North Component (m/s): GGVNS, VNS_G {#ggvns .unnumbered}

*The northward component of ground speed as measured by a global positioning system.* GGVNS originates from a data-system GPS; VNS_G originates from an avionics-system GPS. In the case of GGVNS, when this is used in the calculation of horizontal wind, the following correction would be needed:
\begin{equation}
\mathrm{\{GGVNSA\}} = \mathrm{\{GGVNS\}}+L_{G}\dot{\psi}\frac{\sin\psi}{\cos\phi}
(\#eq:GGVNSA)
\end{equation}  
where GGVNSA is the corrected value used in the wind calculation, $\psi$ and $\phi$ are respectively the heading and roll angles, <span class="math inline">*L*<sub>*G*</sub> =  − 4.30</span> m for the GV, and $\dot{\psi}$ is the rate-of-change of heading (in radians). The variable BYAWR transmitted from the INS gives the rate-of-change of heading <span class="math inline">*ψ̇*</span> after conversion from <span class="math inline">$^{\circ}\thinspace s^{-1}$</span> to radians <span class="math inline">*s*<sup> − 1</sup></span>. This correction is not applied in normal processing because the use of the complementary filter, discussed in Sect.\ \@ref(combining-irs-and-gps-measurements), makes it of negligible importance, as discussed in the note referenced for GGVEW.  

#### GPS-Measured Aircraft Vertical Velocity (m/s): GGVSPD; also (obsolete) VSPD_G and GVZI {#ggvspd .unnumbered}

*The aircraft vertical velocity provided by a GPS unit.* Positive values are upward.<span id="punch3.9" label="punch3.9">[punch3.9]</span> When GGVSPD is used in the calculation of vertical wind, the following correction (omitted before 2017) is applied:<span id="punch:3-13" label="punch:3-13">[punch:3-13]</span>
\begin{equation}
\mathrm{\{GGVSPDA\}} = \mathrm{\{GGVSPD\}}-L_{G}\dot{\theta}
(\#eq:GGVSPDA)
\end{equation}
where <span class="math inline">*L*<sub>*G*</sub> =  − 4.30</span> m for the GV and $\dot{\theta}$ is the rate-of-change of the pitch angle, corresponding to the IRU variable BPITCHR<span>*</span><span class="math inline">*π*</span>/180. The variable GGVSPDA is used internally but not recorded in the data archives. See <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/Recommendation161107.pdf">this memo</a> for additional justification.  

#### GPS Altitude (m MSL): GGALT, GALT_A {#ggalt .unnumbered}

*The aircraft altitude* *measured by a global positioning system.* The measurement is with respect to the geoid as represented internally by the GPS receiver and is determined by adding the adjustment --GGEOIDHT to the direct measurement relative to the ellipsoidal Earth model of the GPS, which is defined by WGS-84. Positive values are above the reference surface. GGALT originates from a data-system GPS; GALT_A originates from an avionics-system GPS. See the discussion of height at the beginning of this subsection and the variable GGEOIDHT below for interpretation of these GPS-based measurements.  

#### GPS Altitude above the WGS94 reference ellipse (m): GGHWGS {#gghwgs .unnumbered}

*The aircraft altitude above the ellipse that is the reference for the WGS-84 coordinate system.* This variable is defined as GGHWGS=GGALT<span class="math inline">+</span>GGEOIDHT.<span id="punch3.4-1" label="punch3.4-1">[punch3.4-1]</span>  

#### GPS Geopotential Altitude (m): GEOPTH {#geoph .unnumbered}

*The aircraft geopotential altitude above mean sea level.* If <span class="math inline">*g*(*z*, *λ*)</span> is the acceleration of gravity as represented by the formula in the Table of Constants in Section \@ref(constants-and-symbols), then the formula used for calculation of GEOPTH is obtained by integrating that formula from the reference surface for MSL (the geoid, <span class="math inline">*Δ*</span> above the WGS84 reference ellipse) to the geometric altitude <span class="math inline">*H*</span>, which is <span class="math inline">*H* + *Δ*</span> above the reference ellipse. The result is normally close (within about 0.5 m) to that obtained with <span class="math inline">*Δ* = 0</span>. There are additional details in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/RecommendationReGEOPHT.pdf">this memo</a>.<br />
```{r child='GEOPTbox.Rmd'}
```

#### GPS Aircraft Track Angle (<span class="math inline">º</span>): GGTRK, TKAT_G {#ggtrk .unnumbered}

*The direction of the aircraft track (degrees clockwise from true north)* as measured by a data-system global positioning system (GGTRK) or an avionics-system GPS (TKAT_G)*.*  

#### GPS Height of the Geoid (m): GGEOIDHT {#ggeoidht .unnumbered}

*Height of geoid, approximating mean sea level, above the WGS-84 ellipsoid.* The height above mean sea level is found by subtracting this value from the height above the WGS-84 reference ellipse as provided by GPS-based measurements.<span id="punch3.4" label="punch3.4">[punch3.4]</span>  

#### GPS Satellites Tracked: GGNSAT {#ggnsat .unnumbered}

*The number of satellites tracked by a GPS unit.*  

#### GPS Quality Flag: GGQUAL {#ggqual .unnumbered} 

*GPS quality flag:*<br />  
```{r child = 'GGQUALbox.Rmd'}
```

#### GPS Mode: GMODE (obsolete) {#gmode .unnumbered}

This is the former output from the Trimble GPS indicating the mode of operation. The normal value is 4, indicating automatic (not manual) mode and that the receiver is operating in 4-satellite (as opposed to fewer) mode.<span id="punch3.5" label="punch3.5">[punch3.5]</span>  

#### GPS Status: GGSTATUS, GSTAT_G, GSTAT {#ggstatus .unnumbered}

The status of the GPS receiver. A value of 1 indicates that the receiver is operating normally; a value of 0 indicates a warning regarding data quality. GGSTATUS indicates the status of the data-system GPS; GSTAT_G indicates the status of the avionics-system GPS. The obsolete variable GSTAT, formerly used for the same purpose, has the reverse meaning: A value of 0 indicates normal operation and any other code indicates a malfunction or warning regarding poor data accuracy.  

<span id="punch:3-14" label="punch:3-14">[punch:3-14]</span>

<!-- <h2 id="other-measurements-of-aircraft-altitude">Other Measurements of Aircraft Altitude</h2> -->

## Other Measurements of Aircraft Altitude {#other-measurements-of-aircraft-altitude}

#### Geometric Radio Altitude (m): HGM - (obsolete) {#hgm .unnumbered}

*The distance to the surface below the aircraft,* measured by a radar altimeter. The maximum range is 762m (2,500 ft). The instrument changes in accuracy at an altitude of 152 m: The estimated error from 152 m to 762 m is 7%, while the estimated error for altitudes below 152 m is 1.5 m or 5%, whichever is greater.  

#### Geometric Radar Altitude (Extended Range) APN-159 (APN-159) (m): HGME {#hgme-159 .unnumbered}

*The distance to the surface below the aircraft, measured by a radar altimeter.* There are two outputs from an APN-159 radar altimeter, one with coarse resolution (CHGME) and one with fine resolution (HGME). Both raw outputs cycle through the range 0-360 degrees, where one cycle corresponds to 4,000 feet for HGME and to 100,000 feet for CHGME. To resolve the ambiguity arising from these cycles, 4,000-foot increments are added to HGME to maintain agreement with CHGME. This preserves the fine resolution of HGME (1.86 m) throughout the altitude range of the APN-159.  

#### Geometric Radar Altitude (Extended Range) APN-232 (m): HGM232 {#hgm-232 .unnumbered}

*Altitude above the ground* as measured by an APN-232 <a name=radar-altimeter>radar altimeter</a>.  

#### Height Above Terrain (m): ALTG {#altg .unnumbered}

*The aircraft altitude above the Earth’s surface* as represented by the next variable. If GGALT is the altitude above mean sea level, ALTG=GGALT<span class="math inline">−</span>SFC.  
 
#### Height of the Earth’s Surface (m MSL): SFC {#sfc .unnumbered}

*The altitude of the Earth’s surface* at a location directly below the aircraft. The data source is the Shuttle Radar Topography Mission of 2000. The height estimate is described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/HeightOfTerrain.pdf">this memo</a>.  

#### Pressure-Damped Inertial Altitude (m): HI3 (obsolete) {#hi3 .unnumbered}

*The aircraft altitude obtained from the twice-integrated IRU acceleration (ACINS), pressure-adjusted to obtain long-term agreement with PALT.* Note that this variable has mixed character, producing short-term variations that accurately track the inertial system changes but with adjustment to the pressure altitude, which is not a true altitude. The variable is not appropriate for estimates of true altitude, but proves useful in the updating algorithm used with the LTN-51 INS for vertical wind. See the discussion of WP3. This variable is now obsolete.  

#### ISA Pressure Altitude (m): PALT {#palt .unnumbered}

*The geopotential altitude in the International Standard Atmosphere where the pressure is equal to the reference barometric (ambient) pressure (PSXC).*^[See “U.S. Standard Atmosphere, 1976”, NASA-TM-A-74335, available for download at <a href="http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19770009539_1977009539.pdf">this URL</a>.]
The pressure altitude is best interpreted as a variable equivalent to the measured pressure, not as a geometric altitude. In the following description of the algorithm, some constants (identified by the symbol <span class="math inline"><sup>‡</sup></span>) are specified as part of the ISA and so should not be “improved” to more modern values such as those given in the table of constants in Section \@ref(constants-and-symbols) (e.g., <span class="math inline">*R*<sub>0</sub><sup>‡</sup>).</span>^[Prior to and including some projects in 2010, processing used slightly different coefficients: for aircraft other than the GV, <span class="math inline">*T*<sub>0</sub>/*λ*</span> was represented by -43308.83, the reference pressure <span class="math inline">*p*<sub>0</sub></span> was taken to be 1013.246, and the exponent <span class="math inline">*x*</span> was represented numerically by 0.190284. For the GV, the value of <span class="math inline">*T*<sub>0</sub>/*λ*</span> was taken to be 44308.0, the transition pressure <span class="math inline">*p*<sub>*T*</sub></span> was 226.1551 hPa, <span class="math inline">*x*</span> = 0.190284, and coefficient <span class="math inline">$\frac{R_{0}^{\prime}T_{T}}{gM_{d}}$</span> was taken to be 6340.70 m instead of 6341.620 m as obtained below. The difference between these older values and the ones recommended below is everywhere less than 10 m and so is small compared to the expected uncertainty in pressure measurements, because 1 hPa change in pressure leads to a change in pressure altitude that varies from about 8–40 m over the altitude range of the GV.]
A note at <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/PressureAltitude.pdf">this link</a> describes the pressure altitude in more detail and documents the change that was made in November 2010.<br />
```{r child = 'PALTbox.Rmd'}
```
<br />
<br />
<br />

#### Altitude, Reference (m MSL): ALTX (Obsolete), GGALTC (Obsolete) {#altx .unnumbered}

<span id="punch3.6" label="punch3.6">[punch3.6]</span> *Derived altitude above the geopotential surface,* obtained by combining information from a GPS receiver and an inertial reference system. This variable was intended to compensate for times when GPS reception was lost by incorporating information from the IRS measurement of altitude. GPS status measurements were used to detect signal loss, although sometimes this signal was delayed for a few seconds after the signal was lost. A 10-second running average was calculated of the difference between the GPS altitude and the reference altitude. When the sample-to-sample altitude difference changed more than 50 meters or when the GPS status detected a degraded signal, the derived variable (ALTX or GGALTC) became the alternate reference altitude adjusted by the latest running-average difference between that reference altitude and GGALT. When reception was recovered, to avoid a sudden discontinuity in altitude, the derived variable was adjusted back to the GPS altitude gradually over the next 10 seconds.<br />
<br />
This obsolete variable should be used with caution because the reference altitude used in past calculations was the IRS altitude updated to the pressure altitude of the aircraft. To account for the difference between pressure and geometric altitude, a regression equation was used, normally <span class="math inline">*z* = *a*<sub>0</sub> + *a*<sub>1</sub> * *PALT*</span> where <span class="math inline">*a*<sub>0</sub> =  − 46.3</span> m and <span class="math inline">*a*<sub>1</sub> = 0.97866</span> but often adjusted dependent on project conditions. This introduced problems in early applications with the GV because it did not account for the pressure-altitude transition at the ISA tropopause. Use of a pressure altitude as reference introduces additional errors in altitude in regions that are not barotropic.<br />  

<!-- <h2 id="subsecirsgpscombining-irs-and-gps-measurements"><span id="subsec:IRS/GPS" label="subsec:IRS/GPS">[subsec:IRS/GPS]</span>Combining IRS and GPS Measurements</h2> -->

## Combining IRS and GPS Measurements {#combining-irs-and-gps-measurements}

Measurements from the global positioning and inertial navigation systems are combined to produce new variables that take advantage of the strengths of each, so that the resulting variables have the long-term stability of the GPS and the short-term resolution of the INS. This section describes some variables that result from this blending of variables. These corrected variables are usually the best available when the GPS and IRS are both functioning.  

One can determine if the GPS is functioning by examining the GPS status variables described in the previous section or by looking for spikes or “flat-lines” in the data. If the GPS data are missing for a short time (a few seconds to a minute), accuracy is not affected. However, longer dropouts will result in uncertainties degrading toward those of the INS. Without the GPS or another ground reference, the IRS error cannot be determined empirically, and one should assume that it is within the manufacturer’s specification (1 nautical mile of error per hour of flight, 90% CEP). When the GPS is active, RAF estimates that the correction algorithm produces a position with an error less than 1.5 m. <span id="punch3.7" label="punch3.7">[punch3.7]</span>Due to the nature of the algorithm, the error will increase from about 1.5 meters to the INS specification in about one-half hour after GPS information is lost.  

#### GPS-Corrected Inertial Ground Speed Vector (m/s):  VEWC, VNSC {#vewc-vnsc .unnumbered}

These variables result from combining GPS and INS output of the east and north components of ground speed from a <span id="compFilter">complementary-filter</span> algorithm. Positive values are toward the east and north, respectively. The smooth, high-resolution, continuous measurements from the inertial navigation system, {VNS, VEW}, which can slowly accumulate errors over time, are combined with the measurements from the GPS, {GVNS, GVEW}, which have good long-term stability, via an approach based on a complementary filter. A low-pass filter, <span class="math inline">*F*<sub>*L*</sub>({*GVNS*, *GVEW*})</span>, is applied to the GPS measurements of groundspeed, which are assumed to be valid for frequencies at or lower than the cutoff frequency <span class="math inline">*f*<sub>*c*</sub></span> of the filter. Then the complementary high-pass filter, denoted (<span class="math inline">1 − *F*<sub>*L*</sub></span>)(<span class="math inline">{*VNS*, *VEW*}</span>), is applied to the IRS measurements of groundspeed, which are assumed valid for frequencies at or higher than <span class="math inline">*f*<sub>*c*</sub></span>. Ideally, the transition frequency would be selected where the GPS errors (increasing with frequency) are equal to the IRS errors (decreasing with frequency).<br />
<br />
The procedure is use now is documented in the <a href="http://dx.doi.org/10.5065/D60G3HJ8">Technical Note on Wind Uncertainty</a>, beginning on p. 125. It is a three-pole Butterworth low-pass filter, originally coded following the algorithm described in Bosic, S. M., 1980: *Digital and Kalman filtering : An Introduction to Discrete-Time Filtering and Optimum Linear Estimation,* p. 49. As described in <a href="https://github.com/NCAR/aircraft_ProcessingAlgorithms/blob/master/www/checkCompFilter.pdf">this memo</a>, it has been revised (2014) to use coefficients generated by the R routine “butter().” The digital filter used is recursive, not centered, to permit calculation during a single pass through the data. If the cutoff frequency lies where both the GPS and INS measurements are almost the same, then the detailed characteristics of the filter (e.g., phase shift) in the transition region do not matter because the complementary filters have canceling effects when applied to the same signal. The transition frequency <span class="math inline">*f*<sub>*c*</sub></span> was chosen to be (1/600) Hz. The Butterworth filter was chosen because it provides flat response away from the transition.^[For historical reasons, the details of the now obsolete filter as originally coded and used for many years are described here. For the current version with coefficients, see the memo referenced above.]<br />
 
```{r child="CF14box.Rmd"}
```
  
The net result then is the sum of these two filtered signals, calculated as described in the following boxes:  
```{r child="CFbox.Rmd"}
```
  
This result is used as long as the GPS signals are continuous and flagged as being valid. When that is not the case, some means is needed to avoid sudden discontinuities in velocity (and hence wind speed), which would introduce spurious effects into variance spectra and other properties dependent on a continuously valid measurement of wind. To extrapolate measurements through periods when the GPS signals are lost (as sometimes occurs, for example, in turns) a fit is determined to the difference between the best-estimate variables {VNSC,VEWC} and the IRS variables {VNS,VEW} for the period before GPS reception was lost, and that fit is used to extrapolate through periods when GPS reception is not available. The procedure is as described below.<br />
<span id="punch:3-15" label="punch:3-15">[punch:3-15]</span>  

<p class=box>
\ 1. If GPS reception has never been valid earlier in the flight, use the INS values without correction.<br>  
\ 2. Whenever both GPS and INS are good, update the low-pass-filtered estimate of the difference between them. This is added to the INS measurement to obtain the corrected variable. Also update a least-squares fit to the difference between the GPS and INS groundspeeds, for each component. The errors are assumed to result primarily from a Schuler oscillation, so the three-term fit is of the form $\Delta=a_1+a_2\sin(\Omega_{Sch}t)+a_3\cos(\Omega_{Sch}t)$, where $\Omega_{Sch}$  is the angular frequency of the Schuler oscillation (taken to be $2\pi/5067$\ s, and $t$ is the time since the start of the flight. A separate fit is used for each component of the velocity and each component of the position (discussed below under LATC and LONC). The <span id='fit-matrix'>fit matrix</span> used to determine these coefficients is updated each time step but the accumulated fit factors decay exponentially with a 30-min decay constant, so the terms used to determine the fit are exponentially weighted over the period of valid data with a time constant that decays exponentially into the past with a characteristic time of 30 min. This is long enough to determine a significant portion of the Schuler oscillation but short enough to emphasize recent measurements of the correction.<br><br>
\ 3. When GPS data become invalid, if sufficient data (spanning 30 min) have been accumulated, invert the accumulated fit matrices to determine the coefficients {$a_1,a_2,a_3$} and then use the formula for $\Delta$ in the preceding step to extrapolate the correction to the IRS measurements while the GPS measurements remain invalid. Doing so immediately would introduce a discontinuity in {VNSC,VEWC}, however, so the correction $\Delta$ is introduced smoothly by adjusting {VNSC, VEWC} as follows: If $dvy$ is the adjustment added to the INS measurement, adjust it according to
$dvy^\prime=\eta\ dvy+(1-\eta)\Delta$ where $dvy^\prime$ is the sequentially adjusted correction and $\eta=0.995$ s$^{-1}$ is chosen to give a decaying transition with a time constant of about 5.5 min. This has the potential to introduce some artificial variance at this scale and so should be considered in cases where variance spectra are analyzed in detail, but it has much less influence on such spectra than a discontinuous transition would. Ideally, the current fit and the last filtered discrepancy (VNSC~0~$-$GVNS~0~ should be about equal, so transitioning between them should not introduce a significant change.<br><br>
\ 4. To avoid transients that would result from switching abruptly to the complementary-filter solution when the GPS measurements again become valid, the correction factors (e.g., $dvy$) are also updated smoothly toward the complementary-filter solution, using for example $dvy^\prime=\eta\ dvy+(1-\eta)F_L(v_y^{GPS}-v_y^{IRS})$ where $F_L$ is the low-pass filter and $v_y$ is the northward component of aircraft groundspeed.
</p>

#### GPS-Corrected Inertial Latitude and Longitude (<span class="math inline">º</span>): LATC, LONC {#latc-lonc .unnumbered}

*Combined GPS and IRS output of latitude and longitude.* Positive values are north and east, respectively.<span id="punch:3-16" label="punch:3-16">[punch:3-16]</span> These variables are the best estimate of position, obtained by the following approach:<br />  
```{r child='LATLONbox.Rmd'}
```

<!-- <strong><span class="underline"></span></strong><br />   -->

